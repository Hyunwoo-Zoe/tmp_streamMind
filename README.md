<h3 align="center"><a href="https://arxiv.org/abs/2503.06220" style="color:#9C276A">
StreamMind: Unlocking Full Frame Rate Streaming Video Dialogue through Event-Gated Cognition</a></h3>
<h5 align="center"> If our project helps you, please give us a star â­ on GitHub to support us. ğŸ™ğŸ™ </h2>

<h5 align="center">

[![arXiv](https://img.shields.io/badge/Arxiv-2503.06220-AD1C18.svg?logo=arXiv)](https://arxiv.org/abs/2503.06220) <br>


## ğŸ“° News
* **[2025.03.18]**  Release training, evaluation, and serving codes of StreamMind.
<div align="center">
    <img src="./assets/framework_v2.png" alt="overview">
</div>

<div align="center">
    <a href="./assets/blind_com_demo.mp4">â–¶ï¸ Click here to watch the demo video</a>
</div>

## ğŸ› ï¸ Requirements and Installation
Basic Dependencies:
* Python >= 3.10
* Pytorch >= 2.5.1
* CUDA Version >= 11.8
* transformers >= 4.44.2 (for mistral tokenizer)
* tokenizers >= 0.19.1 (for mistral tokenizer)

**[Online Mode]** Install required packages (better for development):
```bash
git clone https://github.com/xinding-sys/StreamMind
cd StreamMind
pip install -r requirements.txt
pip install flash-attn==2.5.8 --no-build-isolation
```

## ğŸš€ Main Results

### Streaming Dialogue
<div align="center">
    <img src="./assets/result1.png" alt="overview">
</div>
<div align="center">
    <img src="./assets/result2.png" alt="overview">
</div>

### Offline benchmark
<div align="center">
    <img src="./assets/result3.png" alt="overview">
</div>
<div align="center">
    <img src="./assets/result4.png" alt="overview">
</div>


## ğŸ—ï¸ Training & Evaluation

### Quick Start

1. Training Data Structure:
```bash
StreamMind
â”œâ”€â”€ Online_datasets
â”‚   â”œâ”€â”€ ego4d
|   |   â”œâ”€â”€ v2 
|   |   |   â”œâ”€â”€ annotations 
|   |   |   â”œâ”€â”€ full_scale
â”‚   â”œâ”€â”€ MatchTime
|   |   â”œâ”€â”€ SN-caption 
|   |   â”œâ”€â”€ Video
â”œâ”€â”€ Offline_datasets
â”‚   â”œâ”€â”€ videollava_pt
|   |   â”œâ”€â”€ llava_image/ 
|   |   â”œâ”€â”€ valley/      
|   |   â””â”€â”€ valley_llavaimage.json 
â”‚   â”œâ”€â”€ videollava_sft
|   |   â”œâ”€â”€ llava_image_tune/  
|   |   â”œâ”€â”€ videochatgpt_tune/ 
|   |   â””â”€â”€ videochatgpt_llavaimage_tune.json 
```
2. Command:
```bash
# Streammind train stage 1
bash scripts/custom/finetune_stage1.sh
# Streammind train stage 2
bash scripts/custom/finetune_stage2.sh
# Streammind evaluate
bash scripts/custom/eval/evaluate.sh
```

## ğŸ“‘ Citation

If you find StreamMind useful for your research and applications, please cite using this BibTeX:
```bibtex
@article{ding2025streammind,
  title={StreamMind: Unlocking Full Frame Rate Streaming Video Dialogue through Event-Gated Cognition},
  author={Ding, Xin and Wu, Hao and Yang, Yifan and Jiang, Shiqi and Bai, Donglin and Chen, Zhibo and Cao, Ting},
  journal={arXiv preprint arXiv:2503.06220},
  year={2025}
}
```

## ğŸ‘ Acknowledgement
The codebase of StreamMind is adapted from [**VideoLLaMA 2**](https://github.com/DAMO-NLP-SG/VideoLLaMA2), We are also grateful for the following projects our StreamMind arise from:
* [**Videollm-online**](https://github.com/showlab/videollm-online) [**LLaMA 2**](https://github.com/meta-llama/llama), [**Mistral-7B**](https://mistral.ai/news/announcing-mistral-7b/), [**OpenAI CLIP**](https://openai.com/index/clip/), [**Honeybee**](https://github.com/kakaobrain/honeybee).
* [**Video-ChatGPT**](https://github.com/mbzuai-oryx/Video-ChatGPT), [**Video-LLaVA**](https://github.com/PKU-YuanGroup/Video-LLaVA). 
* [**WebVid**](https://github.com/m-bain/webvid), [**Panda-70M**](https://github.com/snap-research/Panda-70M), [**LanguageBind**](https://github.com/PKU-YuanGroup/LanguageBind), [**InternVid**](https://github.com/OpenGVLab/InternVideo/tree/main/Data/InternVid).
* [**VideoChat2**](https://github.com/OpenGVLab/Ask-Anything/tree/main/video_chat2), [**Valley**](https://github.com/RupertLuo/Valley), [**VTimeLLM**](https://github.com/huangb23/VTimeLLM), [**ShareGPT4V**](https://sharegpt4v.github.io/).


## ğŸ”’ License

This project is released under the Apache 2.0 license as found in the LICENSE file.
The service is a research preview intended for **non-commercial use ONLY**, subject to the model Licenses of LLaMA and Mistral, Terms of Use of the data generated by OpenAI, and Privacy Practices of ShareGPT. Please get in touch with us if you find any potential violations.
